/**
 * File generated by the ThingML IDE
 * /!\Do not edit this file/!\
 * In case of a bug in the generated code,
 * please submit an issue on our GitHub
 **/

package org.thingml.generated;

import no.sintef.jasm.*;
import no.sintef.jasm.ext.*;

import org.thingml.generated.api.*;
import org.thingml.generated.messages.*;

import java.util.*;

/**
 * Definition for type : Client
 **/
public class Client extends Component implements IClient_app {

private boolean debug = false;
public boolean isDebug() {return debug;}
public void setDebug(boolean debug) {this.debug = debug;}
public String toString() {
String result = "instance " + getName() + "\n";
result += "\tcounter = " + Client_counter_var;
result += "\tstart = " + Client_start_var;
result += "\t_a = " + Client__a_var;
result += "\t_b = " + Client__b_var;
result += "\t_c = " + Client__c_var;
result += "\t_d = " + Client__d_var;
result += "\t_e = " + Client__e_var;
result += "\trnd = " + Msgs_rnd_var;
result += "";
return result;
}

public synchronized void m3_via_app(byte Msgs_m3_a_var){
final Event _msg = m3Type.instantiate(Msgs_m3_a_var);
_msg.setPort(app_port);
receive(_msg);
}

private void sendM1_via_app(byte Msgs_m1_a_var, byte Msgs_m1_b_var, byte Msgs_m1_c_var, byte Msgs_m1_d_var, byte Msgs_m1_e_var){
app_port.send(m1Type.instantiate(Msgs_m1_a_var, Msgs_m1_b_var, Msgs_m1_c_var, Msgs_m1_d_var, Msgs_m1_e_var));
}

private void sendM2_via_app(byte Msgs_m2_a_var, byte Msgs_m2_b_var, byte Msgs_m2_c_var){
app_port.send(m2Type.instantiate(Msgs_m2_a_var, Msgs_m2_b_var, Msgs_m2_c_var));
}

//Attributes
private final java.util.Random Msgs_rnd_var;
private long Client_start_var;
private byte Client__c_var;
private long Client_counter_var;
private byte Client__d_var;
private byte Client__e_var;
private byte Client__b_var;
private byte Client__a_var;
private java.util.Random debug_Msgs_rnd_var;
private long debug_Client_start_var;
private byte debug_Client__c_var;
private long debug_Client_counter_var;
private byte debug_Client__d_var;
private byte debug_Client__e_var;
private byte debug_Client__b_var;
private byte debug_Client__a_var;
//Ports
private Port app_port;
//Message types
protected final M1MessageType m1Type = new M1MessageType();
protected final M2MessageType m2Type = new M2MessageType();
protected final M3MessageType m3Type = new M3MessageType();
//Empty Constructor
public Client() {
super();
Msgs_rnd_var = (java.util.Random) new java.util.Random();
Client_start_var = (long) System.currentTimeMillis();
Client_counter_var = (long) 0;
}

//Constructor (only readonly (final) attributes)
public Client(final java.util.Random Msgs_rnd_var) {
super();
this.Msgs_rnd_var = Msgs_rnd_var;
}

//Constructor (all attributes)
public Client(String name, final java.util.Random Msgs_rnd_var, final long Client_start_var, final byte Client__c_var, final long Client_counter_var, final byte Client__d_var, final byte Client__e_var, final byte Client__b_var, final byte Client__a_var) {
super(name);
this.Msgs_rnd_var = Msgs_rnd_var;
this.Client_start_var = Client_start_var;
this.Client__c_var = Client__c_var;
this.Client_counter_var = Client_counter_var;
this.Client__d_var = Client__d_var;
this.Client__e_var = Client__e_var;
this.Client__b_var = Client__b_var;
this.Client__a_var = Client__a_var;
}

//Getters and Setters for non readonly/final attributes
public java.util.Random getMsgs_rnd_var() {
return Msgs_rnd_var;
}

public long getClient_start_var() {
return Client_start_var;
}

public void setClient_start_var(long Client_start_var) {
this.Client_start_var = Client_start_var;
}

public byte getClient__c_var() {
return Client__c_var;
}

public void setClient__c_var(byte Client__c_var) {
this.Client__c_var = Client__c_var;
}

public long getClient_counter_var() {
return Client_counter_var;
}

public void setClient_counter_var(long Client_counter_var) {
this.Client_counter_var = Client_counter_var;
}

public byte getClient__d_var() {
return Client__d_var;
}

public void setClient__d_var(byte Client__d_var) {
this.Client__d_var = Client__d_var;
}

public byte getClient__e_var() {
return Client__e_var;
}

public void setClient__e_var(byte Client__e_var) {
this.Client__e_var = Client__e_var;
}

public byte getClient__b_var() {
return Client__b_var;
}

public void setClient__b_var(byte Client__b_var) {
this.Client__b_var = Client__b_var;
}

public byte getClient__a_var() {
return Client__a_var;
}

public void setClient__a_var(byte Client__a_var) {
this.Client__a_var = Client__a_var;
}

//Getters for Ports
public Port getApp_port() {
return app_port;
}
private CompositeState buildClient(){
final AtomicState state_Client_null_RUN = new AtomicState("RUN");
state_Client_null_RUN.onEntry(()->{
Client__c_var = (byte) (rnd() % 100);
Client__d_var = (byte) (rnd() % 50);
Client__e_var = (byte) (rnd() % 25);
synchronized(System.out) {
System.out.print("#CLI: Come get some app!m1(");
System.out.print(String.format("0x%02X",(getClient__a_var())));
System.out.print(", ");
System.out.print(String.format("0x%02X",(getClient__b_var())));
System.out.print(", ");
System.out.print(String.format("0x%02X",(getClient__c_var())));
System.out.print(", ");
System.out.print(String.format("0x%02X",(getClient__d_var())));
System.out.print(", ");
System.out.print(String.format("0x%02X",(getClient__e_var())));
System.out.print(")!");
System.out.println();
}
sendM1_via_app((byte) (getClient__a_var()), (byte) (getClient__b_var()), (byte) (getClient__c_var()), (byte) (getClient__d_var()), (byte) (getClient__e_var()));
synchronized(System.out) {
System.out.print("#CLI: Come get some app!m2(");
System.out.print(String.format("0x%02X",(getClient__a_var())));
System.out.print(", ");
System.out.print(String.format("0x%02X",(getClient__b_var())));
System.out.print(", ");
System.out.print(String.format("0x%02X",(getClient__c_var())));
System.out.print(")!");
System.out.println();
}
sendM2_via_app((byte) (getClient__a_var()), (byte) (getClient__b_var()), (byte) (getClient__c_var()));
setClient_counter_var((long)(getClient_counter_var() + 1));
});
final FinalState state_Client_null_STOP = new FinalState("STOP");
state_Client_null_STOP.onEntry(()->{
synchronized(System.out) {
System.out.print("#CLI: What are you waitin for? Christmas?");
System.out.println();
}
long stop_var = (long) (System.currentTimeMillis());

synchronized(System.out) {
System.out.print("#CLI: took ");
System.out.print(stop_var - getClient_start_var());
System.out.print("ms.");
System.out.println();
}
stop();
delete();
});
final FinalState state_Client_null_ERROR = new FinalState("ERROR");
state_Client_null_ERROR.onEntry(()->{
synchronized(System.out) {
System.out.print("#CLI: Heh, heh, heh... what a mess!");
System.out.println();
}
stop();
delete();
});
Transition h1282961320 = new Transition();
h1282961320.from(state_Client_null_RUN).to(state_Client_null_STOP);
h1282961320.guard((Event e)->{
return getClient_counter_var() == 100;
});

Transition h1209953289 = new Transition();
h1209953289.from(state_Client_null_RUN).to(state_Client_null_RUN);
h1209953289.event(m3Type);
h1209953289.guard((Event e)->{
final M3MessageType.M3Message m3 = (M3MessageType.M3Message) e;
return m3.a == getClient__a_var();
});

h1209953289.port(app_port);
h1209953289.action((Event e)->{
final M3MessageType.M3Message m3 = (M3MessageType.M3Message) e;
synchronized(System.out) {
System.out.print("#CLI: Ooh, I needed that app?m3(");
System.out.print(String.format("0x%02X",(m3.a)));
System.out.print(")!");
System.out.println();
}
synchronized(System.out) {
System.out.print("#CLI: We meet again, Doctor Jones!");
System.out.println();
}
});

Transition h571836108 = new Transition();
h571836108.from(state_Client_null_RUN).to(state_Client_null_ERROR);
h571836108.event(m3Type);
h571836108.guard((Event e)->{
final M3MessageType.M3Message m3 = (M3MessageType.M3Message) e;
return m3.a != getClient__a_var();
});

h571836108.port(app_port);
h571836108.action((Event e)->{
final M3MessageType.M3Message m3 = (M3MessageType.M3Message) e;
synchronized(System.out) {
System.out.print("#CLI: Ooh, I needed that app?m3(");
System.out.print(String.format("0x%02X",(m3.a)));
System.out.print(")!");
System.out.println();
}
synchronized(System.out) {
System.out.print("#CLI: Damn, you re ugly.");
System.out.println();
}
});

final CompositeState state_Client = new CompositeState("null");
state_Client.onEntry(()->{
Client__a_var = (byte) (rnd());
Client__b_var = (byte) (rnd());
});
state_Client.add(state_Client_null_RUN);
state_Client.add(state_Client_null_STOP);
state_Client.add(state_Client_null_ERROR);
state_Client.initial(state_Client_null_RUN);
return state_Client;
}

public Component buildBehavior(String session, Component root) {
if (root == null) {
//Init ports
app_port = new Port("app", this);
} else {
app_port = ((Client)root).app_port;
}
if (session == null){
//Init state machine
behavior = buildClient();
}
return this;
}

private byte rnd() {
return (byte) ((byte) getMsgs_rnd_var().nextInt(256));
}
}
